# 자주 묻는 질문 (FAQ)

## 설치 및 실행

### Q. 악성코드로 인식합니다.

악성코드가 **아닙니다!**

파이썬으로 제작된 프로그램은 `pyinstaller` 같은 패키징 도구로 실행파일을 만듭니다.
이런 도구로 봇이나 악성코드가 많이 만들어지다 보니 백신에서 오탐지합니다.

**해결**: 백신 프로그램에서 예외 처리 후 사용

### Q. 관리자 권한으로 실행해야 하나요?

**예.** D2R 클라이언트의 핸들을 제어하려면 관리자 권한이 필요합니다.

실행 방법:

1. `d2r_gui.exe`에서 오른쪽 클릭 → **관리자 권한으로 실행**
2. 또는 더블 클릭 후 UAC 창에서 **예** 선택

!!! tip "자동으로 관리자 권한 실행"
    파일 속성 → 호환성 탭 → **관리자 권한으로 이 프로그램 실행** 체크

### Q. "이미 실행중" 이라고 뜹니다.

배틀넷 런처 업데이트 후 발생할 수 있습니다.

**해결**:

1. 실행 중인 D2R 클라이언트와 배틀넷 런처를 모두 종료
2. 프로그램을 다시 실행

그래도 안 되면 배틀넷 런처를 재설치해 보세요.

### Q. 파일 암호화 키(Encryption Key)가 뭔가요?

프로그램 최초 실행 시 입력을 요청하는 키는 **계정 정보 파일을 암호화하기 위한 비밀번호**입니다.

- 입력한 키로 AES 암호화 알고리즘을 사용하여 설정 파일을 암호화합니다
- 다음 실행 시 동일한 키를 입력해야 저장된 계정 정보를 읽을 수 있습니다
- 키를 분실하면 `default.dat` 파일을 삭제하고 계정 정보를 다시 입력해야 합니다

### Q. DLL 오류가 발생합니다.

프로그램을 자주 설치/제거하다 보면 공용 DLL 파일이 삭제되는 경우가 있습니다.

**해결**:

1. 32/64비트 DLL이 혼재되어 있는지 확인
2. 별도로 Python을 설치한 버전이 있다면 충돌 가능성 확인
3. 필요한 DLL 파일을 `windows\system32` 폴더에 복사

### Q. 프로그램 창이 화면 밖으로 사라졌습니다.

**해결**: 레지스트리에서 프로그램의 위치(position) 값을 삭제합니다.

1. 레지스트리 편집기 실행 (`regedit`)
2. 프로그램 관련 항목에서 `pos` 또는 `position`으로 되어 있는 좌표 값을 삭제
3. 프로그램 재실행

### Q. 윈도우 11에서 화면이 멈춥니다 (프리징).

윈도우 11 **24H2** 업데이트 이후 멀티 클라이언트 실행 시 화면 멈춤(프리징) 현상이 보고되고 있습니다.

**해결**:

1. 윈도우 11 **23H2**로 버전을 내리면 해결됩니다
2. 그래도 안 되면 메모리 접촉 상태를 확인하세요

---

## 접속 문제

### Q. 접속이 되지 않습니다.

이 프로그램의 역할은 **클라이언트 실행까지**입니다.
이후 접속 문제는 계정 또는 배틀넷 서버 문제입니다.

**확인사항**:

1. **계정 정보 확인**: 사용자, 비밀번호가 정확한지
2. **CAPTCHA**: 이전 로그인 실패로 CAPTCHA 활성화 여부
3. **OTP**: 인증기 사용 계정은 명령줄 실행 불가
4. **서버 상태**: 점검, 업데이트, 접속자 과다
5. **클라이언트 버전**: 업데이트 필요 여부

### Q. CAPTCHA(퍼즐)가 활성화되었습니다.

잘못된 로그인 정보로 반복 시도하면 블리자드에서 CAPTCHA(봇 체크)를 활성화합니다.

**해결**:

1. **원래 배틀넷 런처**로 정상 로그인을 몇 번 수행합니다
2. CAPTCHA가 더 이상 뜨지 않는 것을 확인한 후 멀티로더를 사용합니다
3. 공유기에서 **새로운 IP**를 다시 받으면 더 빨리 풀립니다

### Q. 친구목록이 뜨지 않습니다.

명령줄 실행 시 친구목록 로딩에 시간이 걸립니다.
배틀넷 런처는 미리 로그인되어 있어서 빠르지만,
명령줄 실행은 순서상 늦게 로딩됩니다.

잠시 기다리면 표시됩니다.

### Q. 연속 실행 시 로그인이 꼬입니다.

토큰 방식은 레지스트리에 토큰을 저장하고 클라이언트가 읽는 방식입니다.
로그인이 완료되기 전에 다음 클라이언트가 실행되면 꼬일 수 있습니다.

**해결**:

1. **환경설정 → 일반 → 실행 간격**을 늘림 (5~6초)
2. 명령줄 방식 사용 (가능한 경우)
3. 실행 후 스크립트 설정

### Q. "서버 접속 불가"가 특정 계정에서만 발생합니다.

토큰이 꼬이거나 만료된 경우 발생할 수 있습니다.

**해결**:

1. 해당 계정의 토큰을 삭제하고 **다시 발급**합니다
2. 계정 정보를 삭제 후 **새로 생성**합니다
3. 인증기를 사용하지 않는 계정이라면 **명령줄 방식**으로 변경해 봅니다

---

## 토큰

### Q. 토큰은 어떻게 만드나요?

**자동 발급 (권장)**:

1. 사용자, 비밀번호 입력
2. 토큰 입력창 옆 아이콘 클릭
3. OTP 사용 시 30초 이내 인증

**수동 발급**:

1. 크롬 시크릿 창 열기
2. `https://us.battle.net/login/en/?externalChallenge=login&app=OSI` 접속
3. 로그인 후 에러 페이지의 `ST=` 뒤 값 복사

### Q. 토큰은 매번 새로 발급해야 하나요?

아닙니다. 한 번 발급받은 토큰은 **계속 사용**할 수 있습니다.

단, 다음 경우 재발급이 필요합니다:

- 비밀번호 변경 시
- 토큰이 만료된 경우 (장기간 미사용)
- 접속 오류가 발생하는 경우

!!! warning "최근 토큰 이슈 (2025~2026)"
    일부 사용자에게서 신규 발급 토큰이 **일회용(30분 한정)**으로 동작하는 현상이 보고되고 있습니다. 기존에 발급받은 토큰은 정상 동작하지만, 새로 발급받은 토큰이 1회만 사용 가능한 경우가 있습니다. 이는 **블리자드 측 정책 변경**으로 인한 것이며, 멀티로더에서 해결할 수 있는 문제가 아닙니다.

### Q. 구글/페이스북 계정으로 토큰 생성이 안됩니다.

토큰 생성은 **배틀넷 이메일과 비밀번호**로 직접 로그인해야 합니다.
구글, 페이스북 등 소셜 로그인으로는 토큰을 발급받을 수 없습니다.

**해결**: 배틀넷 계정 설정에서 이메일/비밀번호 로그인을 설정하세요.

### Q. 토큰 자동 발급 시 브라우저가 뜹니다.

**환경설정 → 고급 설정 → 토큰 생성 → 브라우저 숨김** 활성화

이 옵션을 켜면 토큰 발급 시 브라우저 창이 보이지 않습니다.

### Q. OTP 인증 시간이 부족합니다.

**환경설정 → 고급 설정 → 토큰 생성 → OTP 대기 시간**에서 시간을 늘려주세요. (10~120초)

### Q. 인증기 해제 후에도 토큰 발급 시 인증기 승인이 필요합니다.

인증기를 해제했더라도, 블리자드 측에서 여전히 인증기 승인을 요구하는 경우가 있습니다.

**해결**: 토큰 발행 시 Battle.net 모바일 앱에서 **30초 이내에 승인**을 눌러주세요.

---

## 게임 기능

### Q. 게임 이름은 어떻게 만들어지나요?

`게임 제목 + 일련번호` 형식

- 게임 제목: `MAG`
- 일련번호: `1`
- 자릿수: 2

→ 결과: `MAG01`, `MAG02`, ... `MAG99`

자릿수 변경: **환경설정 → 게임 정보 → 자릿수**

### Q. 여러 계정을 한 번에 방에 넣고 싶습니다.

**자동 기능** (Ctrl+A)을 사용하세요.

1. 모든 계정을 실행
2. 메인 계정이 게임 생성, 나머지가 자동 참가
3. Ctrl+A를 누르면 나가기→생성→참가가 자동 실행

또는 **컨텍스트 메뉴**에서:

1. 메인 계정 선택 → 우클릭 → **게임 생성**
2. 나머지 계정 선택 → 우클릭 → **게임 참가**

!!! warning "자동(Ctrl+A)은 게임 안에서 실행"
    자동 기능은 **모든 계정이 게임 방 안에 있는 상태**에서 실행해야 합니다.
    대기실에서 실행하면 오동작합니다. 대기실에서는 방 만들기/참가를 개별로 해야 합니다.

### Q. 게임 생성/참가 시 입력이 안됩니다.

**스크립트 속도 조정**이 필요합니다.

**환경설정 → 스크립트 관리 → 명령어 지연 (초)** 값을 조정합니다.

- 기본값: 0.09초
- 0.025 단위로 조금씩 늘려보세요
- 권장 범위: 0.075 ~ 0.15

### Q. 방 제목 대신 비밀번호로 방이 생성됩니다.

스크립트 실행 속도가 PC 반응 속도보다 빨라서 발생하는 현상입니다.

**해결**:

1. `script_delay_time` 값을 **0.09 이상**으로 늘립니다
2. 또는 스크립트에서 `copy {game_name},` 앞에 `sleep 0.2,`를 추가합니다

```
    sleep 0.2,        # 잠시 대기 추가
    click 850 55,
    ...
    copy {game_name},
    ...
```

!!! tip
    `script_delay_time`은 전체 명령에 영향을 주므로, 특정 구간에만 `sleep`을 추가하는 것이 효율적입니다.

### Q. 자동(Ctrl+A) 기능이 제대로 동작하지 않습니다.

스크립트의 클릭 좌표가 현재 해상도/모드와 맞지 않을 수 있습니다.

**확인사항**:

1. **창모드**로 실행하고 있는지 확인
2. **환경설정 → 스크립트 관리 → 스크립트 실행 전 창 크기 조정** 활성화
3. 모드(스킨) 사용 시 버튼 위치가 다를 수 있으므로 좌표 수정 필요
4. Ctrl+N(생성), Ctrl+J(참가)가 각각 잘 동작하는지 먼저 확인

### Q. 스크립트 실행 중 오동작합니다.

스크립트 동작 중에 **마우스나 키보드를 조작하면 오동작**합니다.

- 다른 프로그램으로 포커스가 이동하면 해당 프로그램에 키 입력이 전달됩니다
- 채팅창이나 메신저가 열려 있으면 계정 정보가 입력될 수 있으므로 주의하세요
- 스크립트 실행 중에는 **아무 조작도 하지 않는 것**이 좋습니다

### Q. 다른 계정으로 방을 생성하고 싶습니다.

기본적으로 auto 스크립트는 메인(master) 계정이 방을 생성합니다. 다른 계정(예: slave0)이 방을 생성하도록 변경하려면:

```
    loop {all_games},
    execute exit,
    end,
    loop {slave0},
    execute create,
    end,
    loop {slave_games},
    execute join,
    end,
    loop {master_game},
    execute join,
    end,
    sleep 4.5,
    activate {master_game}
```

### Q. /nopickup 상태로 게임을 시작하고 싶습니다.

`/nopickup`은 실행 시 명령줄 옵션으로 지원되지 않습니다. 별도 스크립트로 채팅창을 열어 입력할 수 있습니다:

```
    send enter,
    send /,
    send n,
    send o,
    send p,
    send i,
    send c,
    send k,
    send u,
    send p,
    send enter,
```

---

## 스크립트

### Q. 스크립트 시간 조정 방법이 있나요?

**전체 속도 조정**:

**환경설정 → 스크립트 관리 → 명령어 지연 (초)**

- 값을 낮추면 빨라짐 (오동작 가능)
- 값을 높이면 느려짐 (안정적)
- 권장: 0.075 ~ 0.15

**개별 지연 추가**:

스크립트 편집기에서 `sleep` 명령어를 사용합니다.

```
    sleep 1,        # 1초 대기 후 시작
    click 850 55,
    # ...
```

### Q. 클릭 위치는 어떻게 얻나요?

1. **환경설정 → 스크립트 관리 → 스크립트 실행 전 창 크기 조정** 활성화
2. 창모드에서 실행 (1280x720)
3. AutoHotkey의 **Windows Spy** 같은 도구로 좌표 확인

**비율 좌표** 사용:

```
click 0.5 0.5    # 정중앙
```

**비율 좌표 계산법**:

1. 게임 해상도를 **1280x720**으로 설정
2. 화면 캡처 후 원하는 위치의 좌표(x, y)를 얻음
3. **x좌표 ÷ 1280**, **y좌표 ÷ 720**으로 비율 계산

예: 좌표 (640, 314) → `click 0.5 0.436`

### Q. 자동에서 레거시 모드를 생략하고 싶습니다.

**환경설정 → 스크립트 관리**에서 `auto` 스크립트를 수정합니다.

레거시 관련 부분을 삭제하세요:

```
    loop {all_games},
    execute exit,
    end,
    loop {master_game},
    execute create,
    end,
    loop {slave_games},
    execute join,
    end,
    sleep 4.5,
    activate {master_game}
```

### Q. 메인/부캐 스킨이 다를 때 나가기가 안됩니다.

사용하는 모드(스킨)별로 나가기 버튼 위치가 다르면, 메인용 나가기 스크립트를 별도로 만들어야 합니다.

```
; 메인용 나가기 스크립트 (스킨에 맞는 좌표)
    activate,
    send space,
    send esc,
    sleep 0.1,
    click [메인 나가기 x좌표] [y좌표],
    sleep 0.2

; 오토 스크립트에서 분리
    loop {master_game},
    execute exit_main,
    end,
    loop {slave_games},
    execute exit,
    end,
    loop {master_game},
    execute create,
    end,
    loop {slave_games},
    execute join,
    end,
    sleep 4.5,
    activate {master_game},
    beep
```

가급적 **버튼 위치가 변경되지 않은 스킨**을 사용하는 것을 권장합니다.

---

## 단축키

### Q. 단축키가 먹통이 됩니다.

한/영키가 분리된 103/106키 키보드 문제입니다.

**환경설정 → 고급 설정 → 키보드 → 103/106키 키보드 사용** 활성화

설정 후 프로그램 재시작

!!! note "한/영 키가 분리되어 있지 않은 키보드"
    Alt키와 한/영 키가 같은 키인 키보드는 이 설정이 **필요 없습니다**.

### Q. 단축키를 변경하고 싶습니다.

설정 파일(`d2r.ini`)의 `[Hotkeys]` 섹션에서 원하는 키 조합으로 변경합니다.

예: `ctrl+a`를 `ctrl+0`으로 변경

키 예약어: `alt`, `ctrl`, `shift`, `windows`

### Q. 작업 관리자를 열었더니 단축키가 안 먹힙니다.

작업 관리자 등 시스템 프로그램을 열면 단축키가 먹히지 않는 경우가 있습니다.

**해결**: `Ctrl+Alt`를 동시에 한 번 눌러주면 해결됩니다.

---

## 실행 문제

### Q. 여러 개 실행 시 꺼져버립니다.

**원인**:

- PC/그래픽카드 메모리 부족
- 실행 간격이 너무 빠름

**해결**:

- **환경설정 → 일반 → 실행 간격**을 4초 이상으로 증가

!!! tip "메모리 참고사항"
    - 16GB: 2~3 클라이언트 가능 (저사양 스킨 권장)
    - 32GB: 5 클라이언트 가능 (다소 버벅일 수 있음)
    - 64GB: 5개 이상 안정적 사용 가능

### Q. D2R 클라이언트가 자꾸 죽습니다.

클라이언트를 **최소화하면 메모리 누수** 버그가 있습니다.
사용하지 않더라도 화면 뒤쪽에 띄워 놓으세요.

### Q. 업데이트 오류가 뜨면서 실행이 안됩니다.

여러 클라이언트를 연속 실행할 때 중간에 업데이트 오류가 발생하는 경우입니다.

**해결**:

1. 모든 D2R 클라이언트와 배틀넷 런처 종료
2. 실행 간격을 늘림 (5~6초 이상)
3. 그래도 안 되면 복사해 둔 D2R 폴더를 삭제하고 원본을 다시 복사

### Q. 배틀넷 런처 방식에서 실행이 안됩니다.

**확인사항**:

1. **런처 경로**가 올바른지 확인 (Diablo II Resurrected Launcher.exe)
2. 계정당 **별도 폴더**가 필요합니다 (복사 또는 Junction)
3. **실행 후 스크립트**를 `after_launch`로 설정했는지 확인
4. **환경설정 → 고급 설정 → 배틀넷 런처 → 런처 대기 시간**을 늘려보세요

### Q. 실행 후 자동으로 클릭(캐릭터 선택 화면)이 안됩니다.

최근 버전부터 **실행 후 스크립트**를 별도로 설정해야 합니다.

**해결**: 각 계정에서 **실행 후 스크립트**를 `after_launch`로 설정하고 저장하세요.

### Q. 듀얼 모니터에서 보조 모니터 창이 주 모니터로 이동합니다.

**스크립트 실행 전 창 크기 조정** 옵션이 활성화되어 있으면, 스크립트 실행 시 창을 리사이즈하면서 주 모니터로 이동할 수 있습니다.

**해결**: `resize_window = False`로 설정하세요.

### Q. 최소 창 크기 제한이 있나요?

게임 화면은 **1280x720** 이하로는 100% 표시가 불가능합니다. 이 크기 이하에서는 좌측/하단부터 잘리게 됩니다. sizer 같은 도구로 더 줄일 수는 있지만, 좌표가 달라져서 멀티로더의 클릭 위치가 맞지 않게 됩니다.

---

## 설정 관련

### Q. 설정이 초기화됩니다.

D2R은 마지막 저장/종료한 설정이 모든 클라이언트에 적용됩니다.

**해결**: 클라이언트별 설정파일 지정

1. `%userprofile%\Saved Games\Diablo II Resurrected\Settings.json` 복사
2. 원하는 이름으로 저장 (예: `Settings_Low.json`)
3. 계정 설정에서 설정파일 선택

!!! info "설정 파일 동작 원리"
    A 계정에 `A.json`을 지정하면, 실행 시 `A.json`을 `Settings.json`으로 교체하여 로드합니다. 이후 게임 내에서 설정을 변경해도 반영되는 파일은 `A.json`이 아닌 원래 `Settings.json`입니다. 따라서 **설정 변경 후에는 `Settings.json`을 다시 복사하여 `A.json`으로 저장**해야 합니다.

### Q. 계정 정보를 저장했는데 사라졌습니다.

계정 정보 입력 후 반드시 **파일 → 저장** (Ctrl+S)을 해야 합니다.
저장하지 않으면 프로그램 종료 시 사라집니다.

### Q. 설정을 다른 PC로 옮기고 싶습니다.

**환경설정 → 현재 설정을 파일로 저장**으로 설정 파일을 내보낸 후,
새 PC에서 **환경설정 → 파일에서 설정 읽기**로 가져옵니다.

계정 정보는 별도로 `default.dat` 파일을 복사하세요.

!!! warning "버전 간 호환"
    다른 버전의 설정(ini) 파일을 그대로 가져오면 오류가 발생할 수 있습니다. 새 버전에서는 설정 파일을 삭제하고 새로 생성하는 것을 권장합니다.

### Q. INI 파일은 어디서 만드나요? (v40 이후)

v40 이후 버전에서는 **INI 파일을 더 이상 사용하지 않습니다**.

**환경설정 → 환경설정 변경**에서 모든 설정을 관리합니다.

### Q. 이전 버전을 계속 사용해도 되나요?

네, 이전 버전을 그대로 사용해도 됩니다. 새 버전은 모양만 바뀌었고 기존 기능들과 동일합니다.

---

## 폴더 및 모드

### Q. 폴더 복사를 해야 하나요?

- **명령줄 실행**: 복사 불필요
- **웹 토큰 실행**: 계정당 하나씩 필요 (정션 폴더 가능)
- **배틀넷 런처**: 계정당 하나씩 필요

용량이 부족하면 **정션(Junction) 폴더** 사용:

**도구 → 링크폴더 만들기**

또는 수동으로:

```cmd
mklink /j "C:\...\Diablo II Resurrected2" "C:\...\Diablo II Resurrected"
```

### Q. 모드 적용은 어떻게 하나요?

1. `D2R 설치폴더\mods\모드명` 폴더에 모드 파일 배치
2. 계정 설정에서 **런처**를 `d2r.exe`로 선택
3. **모드** 콤보박스에서 모드 선택
4. 저장 후 실행

!!! note "참고"
    Launcher.exe는 실행 방식이 달라 모드 선택이 안됩니다.

!!! warning "모드 압축 해제 확인"
    모드 파일의 폴더 구조를 확인하세요. 폴더 안에 같은 이름의 폴더가 중첩되어 풀리는 경우가 많습니다.

### Q. 나가기 버튼 클릭이 이상한 위치입니다.

사용하는 모드(스킨)에서 버튼 위치가 변경된 경우입니다.

**해결**:

1. 기본 스킨 사용
2. 또는 **환경설정 → 스크립트 관리**에서 나가기 스크립트의 클릭 좌표 수정

**키보드로 나가기**:

```
    activate,
    send esc,
    send up,
    send enter
```

!!! tip "엽굵 모드 사용자"
    엽굵 모드의 경우 나가기 버튼 좌표를 `click 0.5 0.555`로 수정하면 됩니다.
    또는 모드 파일에서 `data\global\ui\layouts\pauselayouthd.json` 파일을 삭제하면 종료 창이 기본 모드로 변경됩니다.

---

## 스페이스바 관련

### Q. 스페이스바를 다른 기능(큐브 등)에 바인딩했더니 자동 기능이 안됩니다.

나가기 스크립트에서 인벤토리/상태창을 닫기 위해 `send space`를 사용합니다. 스페이스바를 다른 용도로 바인딩하면 오동작합니다.

**해결**: 설정 파일에서 `exit` 스크립트의 `send space,` 라인을 삭제하세요.

```
    activate,
    send esc,        # send space 라인 삭제
    sleep 0.1,
    click 0.5 0.436,
    sleep 0.2
```

---

## 기타

### Q. 매크로가 동작하지 않습니다.

D2R 클라이언트가 관리자 권한으로 실행되므로,
AHK, 로지텍 GHub, PowerToys 등도 **관리자 권한**으로 실행해야 합니다.

### Q. 사용 중 밴(정지)될 수 있나요?

이 프로그램의 사용으로 발생하는 모든 문제에 대한 **책임은 사용자 본인**에게 있습니다.

### Q. 외부 프로그램(AHK 등)에서 멀티로더 단축키를 전송하면 오동작합니다.

외부에서 단축키를 전송하면 활성화된 창이 없어 모든 클라이언트가 **Slave**로 인식될 수 있습니다. Main과 Slave는 **실행 시점에 활성화된 창**을 기준으로 판단합니다.

### Q. 로그 파일은 어떻게 확인하나요?

문제 해결을 위해 로그 파일을 확인할 수 있습니다.

1. 메뉴에서 **로그 보기** 활성화
2. `d2r.log` 파일이 생성됩니다
3. [SnakeTail](https://snakenest.com/) 같은 프로그램으로 실시간 모니터링 가능

!!! note
    로그 파일에는 계정 정보(패스워드 등)가 표시되지 않으므로, 문제 발생 시 로그를 공유해도 안전합니다.

### Q. 배틀넷 런처 없이도 사용 가능한가요?

명령줄 방식이라면 배틀넷 런처 없이 사용 가능합니다. 다만 **업데이트**나 **CAPTCHA 해결** 시에는 배틀넷 런처가 필요합니다.

### Q. 명령줄 방식과 토큰 방식 중 어떤 것이 좋나요?

| 항목 | 명령줄 | 토큰 |
|------|--------|------|
| 인증기 | 해제 필요 | 사용 가능 |
| 폴더 복사 | 불필요 | 필요 (정션 가능) |
| 안정성 | 높음 | 높음 |
| 아시아 서버 | 차단됨 | 사용 가능 |
| 보안 | 계정 정보 직접 전달 | 토큰으로 인증 |

- **인증기 미사용 + 해외 서버**: 명령줄 방식 추천
- **인증기 사용 또는 아시아 서버**: 토큰 방식 필수
